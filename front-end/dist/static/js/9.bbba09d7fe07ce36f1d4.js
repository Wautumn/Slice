webpackJsonp([9],{"9r/T":function(t,e,a){(function(t){var s=void 0!==t&&t||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function r(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new r(n.call(setTimeout,s,arguments),clearTimeout)},e.setInterval=function(){return new r(n.call(setInterval,s,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(s,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},a("AYvJ"),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(e,a("9AUj"))},AYvJ:function(t,e,a){(function(t,e){!function(t,a){"use strict";if(!t.setImmediate){var s,n,r,i,o,u=1,c={},l=!1,m=t.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(t);h=h&&h.setTimeout?h:t,"[object process]"==={}.toString.call(t.process)?s=function(t){e.nextTick(function(){f(t)})}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,a=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=a,e}}()?t.MessageChannel?((r=new MessageChannel).port1.onmessage=function(t){f(t.data)},s=function(t){r.port2.postMessage(t)}):m&&"onreadystatechange"in m.createElement("script")?(n=m.documentElement,s=function(t){var e=m.createElement("script");e.onreadystatechange=function(){f(t),e.onreadystatechange=null,n.removeChild(e),e=null},n.appendChild(e)}):s=function(t){setTimeout(f,0,t)}:(i="setImmediate$"+Math.random()+"$",o=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(i)&&f(+e.data.slice(i.length))},t.addEventListener?t.addEventListener("message",o,!1):t.attachEvent("onmessage",o),s=function(e){t.postMessage(i+e,"*")}),h.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),a=0;a<e.length;a++)e[a]=arguments[a+1];var n={callback:t,args:e};return c[u]=n,s(u),u++},h.clearImmediate=d}function d(t){delete c[t]}function f(t){if(l)setTimeout(f,0,t);else{var e=c[t];if(e){l=!0;try{!function(t){var e=t.callback,s=t.args;switch(s.length){case 0:e();break;case 1:e(s[0]);break;case 2:e(s[0],s[1]);break;case 3:e(s[0],s[1],s[2]);break;default:e.apply(a,s)}}(e)}finally{d(t),l=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(e,a("9AUj"),a("V0EG"))},GKp8:function(t,e){},V0EG:function(t,e){var a,s,n=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(t){if(a===setTimeout)return setTimeout(t,0);if((a===r||!a)&&setTimeout)return a=setTimeout,setTimeout(t,0);try{return a(t,0)}catch(e){try{return a.call(null,t,0)}catch(e){return a.call(this,t,0)}}}!function(){try{a="function"==typeof setTimeout?setTimeout:r}catch(t){a=r}try{s="function"==typeof clearTimeout?clearTimeout:i}catch(t){s=i}}();var u,c=[],l=!1,m=-1;function h(){l&&u&&(l=!1,u.length?c=u.concat(c):m=-1,c.length&&d())}function d(){if(!l){var t=o(h);l=!0;for(var e=c.length;e;){for(u=c,c=[];++m<e;)u&&u[m].run();m=-1,e=c.length}u=null,l=!1,function(t){if(s===clearTimeout)return clearTimeout(t);if((s===i||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(t);try{s(t)}catch(e){try{return s.call(null,t)}catch(e){return s.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)e[a-1]=arguments[a];c.push(new f(t,e)),1!==c.length||l||o(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},v5Mt:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("HzJ8"),n=a.n(s),r=a("9r/T"),i={components:{tasklist:a("fU07").default},data:function(){return{tomoStartTime:"",dailySummary:"",selfRating:0,countButtonType:"success",countOn:!1,selected:!1,selectCancel:!1,count:"0",minutes:"0",seconds:"0",timer:null,getcurrentTime:null,previousStartTime:new Date,currentTask:null,currentTaskName:"",currentTaskDetail:"",currentFinishedPomo:null,currentTotalPomo:null,currentCondition:!1,currentStatus:-2,currentDeadline:null,taskData:[],taskRequestUrl:"http://localhost:8080/task/getTask",taskStartUrl:"http://localhost:8080/task/startTask",tomatoStartUrl:"http://localhost:8080/startTomato",tomatoBreakUrl:"http://localhost:8080/breakTomato",tomatoEndUrl:"http://localhost:8080/endTomato",deleteTaskUrl:"http://localhost:8080/task/deleteTask",modifyTaskUrl:"http://localhost:8080/task/modifyTask",breakTaskUrl:"http://localhost:8080/task/breakTask",endTaskUrl:"http://localhost:8080/task/endTask",dailySummaryUrl:"http://localhost:8080/summary/save"}},mounted:function(){var t=this;this.getcurrentTime=this.currentTime(),this.getcurrentTime=this.getcurrentTime.substring(0,19),this.$http.get(this.taskRequestUrl,{params:{userId:sessionStorage.userId}}).then(function(e){t.taskData=e.data;var a=[],s=!0,r=!1,i=void 0;try{for(var o,u=n()(t.taskData);!(s=(o=u.next()).done);s=!0){var c=o.value;c.deadline>=t.getcurrentTime&&a.push(c)}}catch(t){r=!0,i=t}finally{try{!s&&u.return&&u.return()}finally{if(r)throw i}}t.taskData=a}),sessionStorage.listLock="false",console.log(this.getcurrentTime)},methods:{startCount:function(){var t=this;if(this.selected){if(sessionStorage.tomoLength)var e=60*parseInt(sessionStorage.tomoLength);else e=5;e=5;this.timer||(this.count=e,this.countOn=!0,sessionStorage.listLock="true",this.countButtonType="danger",this.seconds=this.count%60,this.minutes=parseInt(this.count/60),0==this.taskData[this.currentTask].status&&(this.$http.get(this.taskStartUrl,{params:{userId:sessionStorage.userId,taskName:this.taskData[this.currentTask].name}}),this.taskData[this.currentTask].status=1),this.tomoStartTime=(new Date).format("yyyy-MM-dd hh:mm:ss"),this.$http.get(this.tomatoStartUrl,{params:{userId:sessionStorage.userId,taskName:this.currentTaskName,startTime:this.tomoStartTime}}),this.timer=Object(r.setInterval)(function(){t.count>0&&t.count<=e?(t.count--,t.seconds=t.count%60,t.minutes=parseInt(t.count/60)):(t.countOn=!1,t.countButtonType="success",Object(r.clearInterval)(t.timer),t.timer=null,sessionStorage.listLock="false",0==t.count&&(t.currentFinishedPomo++,t.taskData[t.currentTask].tomatoCompleted++,t.$http.get(t.tomatoEndUrl,{params:{userId:sessionStorage.userId,needAssociation:!0,taskName:t.currentTaskName,startTime:t.tomoStartTime,endTime:(new Date).format("yyyy-MM-dd hh:mm:ss")}}),t.$http.get(t.modifyTaskUrl,{params:{userId:sessionStorage.userId,taskName:t.currentTaskName,property:"tomatoCompleted",value:t.currentFinishedPomo}}),t.taskData[t.currentTask].tomatoCompleted==t.taskData[t.currentTask].expectedTomato?t.currentCondition=!0:t.currentCondition=!1))},1e3))}else this.$alert("请选择一个任务以开始本番茄钟","提示",{confirmButtonText:"确定",callback:function(t){}})},stopCount:function(){this.count="-1",this.minutes="0",this.seconds="0",this.$http.get(this.tomatoBreakUrl,{params:{userId:sessionStorage.userId,breakTime:(new Date).format("yyyy-MM-dd hh:mm:ss"),startTime:this.tomoStartTime}})},getTask:function(t){var e=this;if("new"==t)return this.$http.get(this.taskRequestUrl,{params:{userId:sessionStorage.userId}}).then(function(t){e.taskData=t.data;var a=[],s=!0,r=!1,i=void 0;try{for(var o,u=n()(e.taskData);!(s=(o=u.next()).done);s=!0){var c=o.value;c.deadline>=e.getcurrentTime&&a.push(c)}}catch(t){r=!0,i=t}finally{try{!s&&u.return&&u.return()}finally{if(r)throw i}}e.taskData=a}),void console.log(this.taskData);for(this.selectCancel?this.selectCancel=!1:this.selected=!0,this.currentTask=0;this.taskData[this.currentTask]!=t&&this.taskData[this.currentTask]!=t;this.currentTask++);this.currentTaskName=t.name,this.currentFinishedPomo=t.tomatoCompleted,this.currentTotalPomo=parseInt(t.expectedTomato),this.currentTaskDetail=t.description,this.currentDeadline=t.deadline,this.currentStatus=t.status,this.taskData[this.currentTask].tomatoCompleted==this.taskData[this.currentTask].expectedTomato?this.currentCondition=!0:this.currentCondition=!1},deleteTask:function(){var t=this;this.$confirm("此操作将永久删除该任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.get(t.deleteTaskUrl,{params:{userId:t.taskData[t.currentTask].userId,taskName:t.taskData[t.currentTask].name,starttime:null}}).then(function(){t.$http.get(t.taskRequestUrl,{params:{userId:sessionStorage.userId}}).then(function(e){t.taskData=e.data;var a=[],s=!0,r=!1,i=void 0;try{for(var o,u=n()(t.taskData);!(s=(o=u.next()).done);s=!0){var c=o.value;c.deadline>=t.getcurrentTime&&a.push(c)}}catch(t){r=!0,i=t}finally{try{!s&&u.return&&u.return()}finally{if(r)throw i}}t.taskData=a,t.selectCancel=!0,t.selected=!1,t.$message({type:"success",message:"删除成功!"})})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},finishTask:function(){this.$http.get(this.endTaskUrl,{params:{userId:sessionStorage.userId,taskName:this.currentTaskName,startTime:(new Date).format("yyyy-MM-dd hh:mm:ss")}}),this.taskData[this.currentTask].status=2,this.currentStatus=2},breakTask:function(){var t=this;this.$confirm("此操作将废弃当前任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.get(t.breakTaskUrl,{params:{userId:sessionStorage.userId,taskName:t.currentTaskName}}),t.taskData[t.currentTask].status=-1,t.currentStatus=-1,t.$message({type:"success",message:"废弃成功!"})}).catch(function(){t.$message({type:"info",message:"已取消废弃"})})},onSubmit:function(){var t=this;this.$http.get(this.modifyTaskUrl,{params:{userId:sessionStorage.userId,taskName:this.taskData[this.currentTask].name,property:"description",value:this.currentTaskDetail}}).then(function(){t.$http.get(t.taskRequestUrl,{params:{userId:sessionStorage.userId}}).then(function(e){t.taskData=e.data;var a=[],s=!0,r=!1,i=void 0;try{for(var o,u=n()(t.taskData);!(s=(o=u.next()).done);s=!0){var c=o.value;c.deadline>=t.getcurrentTime&&a.push(c)}}catch(t){r=!0,i=t}finally{try{!s&&u.return&&u.return()}finally{if(r)throw i}}t.taskData=a,t.$message({message:"保存成功！",type:"success"})})})},dateFtt:function(t,e){var a={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var s in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+s+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?a[s]:("00"+a[s]).substr((""+a[s]).length)));return t},currentTime:function(){var t=new Date;return this.dateFtt("yyyy-MM-dd hh:mm:ss",t)},saveDailySummary:function(){var t=this;this.$http.get(this.dailySummaryUrl,{params:{userid:sessionStorage.userId,content:this.dailySummary,time:this.getcurrentTime,selfRating:this.selfRating}}).then(function(){t.$http.get(t.taskRequestUrl,{params:{userId:sessionStorage.userId}}).then(function(e){t.taskData=e.data;var a=[],s=!0,r=!1,i=void 0;try{for(var o,u=n()(t.taskData);!(s=(o=u.next()).done);s=!0){var c=o.value;c.deadline>=t.getcurrentTime&&a.push(c)}}catch(t){r=!0,i=t}finally{try{!s&&u.return&&u.return()}finally{if(r)throw i}}t.taskData=a,t.$message({message:"保存成功！",type:"success"})})})}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-container",[a("el-aside",{attrs:{width:"400px"}},[a("tasklist",{attrs:{tableData:t.taskData},on:{transferTask:t.getTask}})],1),t._v(" "),a("el-main",[a("div",{staticStyle:{"text-align":"center"}},[a("strong",{staticStyle:{"font-size":"200px","line-height":"300px",color:"#409eff"}},[t._v(t._s(t.minutes)+":"+t._s(t.seconds))]),t._v(" "),a("br"),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.currentCondition,expression:"!currentCondition"}],attrs:{type:t.countButtonType,disabled:t.countOn||-1==t.currentStatus},on:{click:t.startCount}},[t._v("开始番茄钟")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.currentCondition,expression:"!currentCondition"}],attrs:{type:"warning",disabled:!t.countOn},on:{click:t.stopCount}},[t._v("中止番茄钟")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.currentCondition,expression:"currentCondition"}],attrs:{type:"success",disabled:2==t.currentStatus},on:{click:t.finishTask}},[t._v("完成任务")]),t._v(" "),a("br")],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.selected,expression:"selected"}],staticStyle:{"margin-left":"20px","margin-right":"20px"}},[a("div",{staticStyle:{"margin-top":"20px","margin-bottom":"20px"}},[a("h1",[t._v(t._s(t.currentTaskName))])]),t._v(" "),a("el-steps",{attrs:{active:t.currentFinishedPomo,space:"100px","finish-status":"success"}},t._l(t.currentTotalPomo,function(t){return a("el-step")}),1),t._v(" "),a("br"),t._v(" "),a("h1",{directives:[{name:"show",rawName:"v-show",value:t.selected,expression:"selected"}],staticStyle:{"margin-top":"10px"}},[t._v("任务时间")]),t._v(" "),a("div",{staticStyle:{"margin-top":"10px","margin-bottom":"10px","margin-left":"20px"}},[a("h2",[t._v("至"+t._s(t.currentDeadline))])]),t._v(" "),a("h1",{directives:[{name:"show",rawName:"v-show",value:t.selected,expression:"selected"}]},[t._v("任务详情")]),t._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:t.selected,expression:"selected"}]},[a("el-form-item",[a("el-input",{attrs:{type:"textarea",disabled:t.currentCondition},model:{value:t.currentTaskDetail,callback:function(e){t.currentTaskDetail=e},expression:"currentTaskDetail"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("保存")]),t._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"danger"},on:{click:t.deleteTask}},[t._v("删除记录")]),t._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"warning",disabled:-1==t.currentStatus},on:{click:t.breakTask}},[t._v("废弃任务")])],1)],1)],1)],1),t._v(" "),a("el-footer",{staticStyle:{"margin-top":"30px"},attrs:{height:"60px"}},[a("h1",[t._v("每日小结 "+t._s(t.getcurrentTime))]),t._v(" "),a("Rate",{attrs:{"show-text":"","allow-half":""},model:{value:t.selfRating,callback:function(e){t.selfRating=e},expression:"selfRating"}},[a("span",{staticStyle:{color:"#f5a632"}},[t._v(t._s(t.selfRating))])]),t._v(" "),a("el-input",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"},attrs:{type:"textarea"},model:{value:t.dailySummary,callback:function(e){t.dailySummary=e},expression:"dailySummary"}}),t._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.saveDailySummary}},[t._v("提交")])],1)],1)],1)],1)},staticRenderFns:[]};var u=a("C7Lr")(i,o,!1,function(t){a("GKp8")},null,null);e.default=u.exports}});
//# sourceMappingURL=9.bbba09d7fe07ce36f1d4.js.map